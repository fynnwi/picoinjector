<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="picoinjector">
<title>Log Files • picoinjector</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Log Files">
<meta property="og:description" content="picoinjector">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">picoinjector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/droplet_volumes.html">Volumes and Concentrations</a>
    <a class="dropdown-item" href="../articles/electrical_engineering.html">Electrical Engineering</a>
    <a class="dropdown-item" href="../articles/fads_analysis.html">FADS Analysis</a>
    <a class="dropdown-item" href="../articles/hydraulic_resistance.html">Hydraulic resistance</a>
    <a class="dropdown-item" href="../articles/logfiles.html">Log Files</a>
    <a class="dropdown-item" href="../articles/spincurves.html">SU-8 3035 Spincurve Analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Log Files</h1>
            
      
      
      <div class="d-none name"><code>logfiles.Rmd</code></div>
    </div>

    
    
<p>During a picoinjection or droplet making experiment, it can be
important to know the fluid flow parameters at any given time, e.g. in
order to link them to an image that was taken at a specific time. Both,
the OB1 pressure controller and the Cetoni syringe pump allow to record
the history of parameters, i.e. pressure or flowrate, over time and
store them in a log file.</p>
<p>In this vignette, I will format and analyse those log files in order
to show them in a single plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">picoinjector</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># show fractional seconds with three digits</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits.secs <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>What do I want?</p>
<ul>
<li>plot with q_oil, q_emulsion and p_injection on the y-axis, time on
the x-axis</li>
<li>function to give me pressure and flowrates for a given time</li>
</ul>
<p>Challenge:</p>
<ul>
<li>align pressure and syringe pump profiles such that the timesteps are
the same</li>
</ul>
<p>Overall workflow:</p>
<ol style="list-style-type: decimal">
<li>Read in the log files</li>
<li>Find values of elapsed time of both syringe and pressure log in
order to align them</li>
<li>Plot</li>
</ol>
<div class="section level3">
<h3 id="syringe-pump">syringe pump<a class="anchor" aria-label="anchor" href="#syringe-pump"></a>
</h3>
<p>The Cetoni syringe pump log file can be loaded using the convenience
function <code>logfile_read_syringepump</code>. This reads the CSV file
and formats the columns a little bit.</p>
<p>(This function works only for a particular configuration of the log
file in the Cetoni Elements software.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">syringe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logfile_read_syringepump.html">logfile_read_syringepump</a></span><span class="op">(</span><span class="st">"data/logfiles/syringe_pump_log_20220805_150634.csv"</span><span class="op">)</span></span>
<span><span class="va">syringe</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 149,607 × 4</span></span></span>
<span><span class="co">#&gt;    elapsed_time timestamp               channel flowrate</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          0   2022-08-05 <span style="color: #949494;">15:06:34.569</span> q1            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          0   2022-08-05 <span style="color: #949494;">15:06:34.569</span> q2            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          0   2022-08-05 <span style="color: #949494;">15:06:34.569</span> q3             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          0.1 2022-08-05 <span style="color: #949494;">15:06:34.669</span> q1            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          0.1 2022-08-05 <span style="color: #949494;">15:06:34.669</span> q2            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          0.1 2022-08-05 <span style="color: #949494;">15:06:34.669</span> q3             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          0.2 2022-08-05 <span style="color: #949494;">15:06:34.769</span> q1            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          0.2 2022-08-05 <span style="color: #949494;">15:06:34.769</span> q2            10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          0.2 2022-08-05 <span style="color: #949494;">15:06:34.769</span> q3             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          0.3 2022-08-05 <span style="color: #949494;">15:06:34.868</span> q1            10</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 149,597 more rows</span></span></span></code></pre></div>
<p>It can be seen that every row contains an absolute time stamp which
will allow us to associate the flowrate with images data acquired on the
microscope.</p>
<p>As will be shown later, the pressure controller log file <em>does
not</em> contain absolute timestamps, just a column for the elapsed
time. However, by aligning flowrate and pressure profiles, the absolute
time stamp can also be inferred for the pressure log. To that end, one
has to include an alignment mark during the experiment, e.g. by setting
both, pressure and syringe pump to a specific value at the exact same
time. By inspecting the resulting profiles, one can identify the
alignment mark and shift the pressure profile so that both alignment
marks conincide with the same time.</p>
<p>An overview graph of the syringe pump flowrate can be plotted using
<code>logfile_plot_syringepump</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logfile_plot_syringepump.html">logfile_plot_syringepump</a></span><span class="op">(</span><span class="va">syringe</span><span class="op">)</span></span></code></pre></div>
<p><img src="logfiles_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Here, the alignment mark is at the end of the experiment, around
minute 81, where flowrate on channel 2 and pressure on channel 2 were
set to zero. Zoom on the x-axis to find the precise time:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logfile_plot_syringepump.html">logfile_plot_syringepump</a></span><span class="op">(</span><span class="va">syringe</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">81.5</span>, <span class="fl">82</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 148704 row(s) containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="logfiles_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Investigate the logfile rows in order to find the exact time when q2
was set to zero:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">syringe</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">channel</span> <span class="op">==</span> <span class="st">"q2"</span>,</span>
<span>         <span class="va">elapsed_time</span> <span class="op">&gt;</span> <span class="fl">4904</span> <span class="op">&amp;</span> <span class="va">elapsed_time</span> <span class="op">&lt;</span> <span class="fl">4905</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt;   elapsed_time timestamp               channel flowrate</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>        <span style="text-decoration: underline;">4</span>904. 2022-08-05 <span style="color: #949494;">16:28:17.611</span> q2           300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        <span style="text-decoration: underline;">4</span>904. 2022-08-05 <span style="color: #949494;">16:28:17.711</span> q2           300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        <span style="text-decoration: underline;">4</span>904. 2022-08-05 <span style="color: #949494;">16:28:17.812</span> q2           300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        <span style="text-decoration: underline;">4</span>904. 2022-08-05 <span style="color: #949494;">16:28:17.911</span> q2           300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        <span style="text-decoration: underline;">4</span>904. 2022-08-05 <span style="color: #949494;">16:28:18.012</span> q2           300</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>        <span style="text-decoration: underline;">4</span>905. 2022-08-05 <span style="color: #949494;">16:28:18.111</span> q2             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>        <span style="text-decoration: underline;">4</span>905. 2022-08-05 <span style="color: #949494;">16:28:18.211</span> q2             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>        <span style="text-decoration: underline;">4</span>905. 2022-08-05 <span style="color: #949494;">16:28:18.312</span> q2             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>        <span style="text-decoration: underline;">4</span>905. 2022-08-05 <span style="color: #949494;">16:28:18.411</span> q2             0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pressure-controller">pressure controller<a class="anchor" aria-label="anchor" href="#pressure-controller"></a>
</h3>
<p>A drawback of the pressure controller log files is, that the system
time is not stored. Therefore, we need to align the pressure profile
with the syringe pump profile in order to get that information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pressure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logfile_read_pressure.html">logfile_read_pressure</a></span><span class="op">(</span><span class="st">"data/logfiles/pressure_log.txt"</span><span class="op">)</span></span>
<span><span class="va">pressure</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 394,856 × 4</span></span></span>
<span><span class="co">#&gt;    elapsed_time channel value    mbar</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          0   p1      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          0   p1      read    0.612</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          0   p2      target 50    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          0   p2      read   50.0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          0   p3      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          0   p3      read    0.970</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          0   p4      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          0   p4      read    0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          0.1 p1      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          0.1 p1      read    0.605</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 394,846 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logfile_plot_pressure.html">logfile_plot_pressure</a></span><span class="op">(</span><span class="va">pressure</span><span class="op">)</span></span></code></pre></div>
<p><img src="logfiles_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Find time when p2 was set to zero:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pressure</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">channel</span> <span class="op">==</span> <span class="st">"p2"</span>,</span>
<span>         <span class="va">value</span> <span class="op">==</span> <span class="st">"target"</span>,</span>
<span>         <span class="va">elapsed_time</span> <span class="op">&gt;</span> <span class="fl">4861.5</span> <span class="op">&amp;</span> <span class="va">elapsed_time</span> <span class="op">&lt;</span> <span class="fl">4862.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt;   elapsed_time channel value   mbar</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>        <span style="text-decoration: underline;">4</span>862. p2      target   554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        <span style="text-decoration: underline;">4</span>862. p2      target   554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        <span style="text-decoration: underline;">4</span>862. p2      target   554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        <span style="text-decoration: underline;">4</span>862. p2      target   554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        <span style="text-decoration: underline;">4</span>862  p2      target   554</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>        <span style="text-decoration: underline;">4</span>862. p2      target     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>        <span style="text-decoration: underline;">4</span>862. p2      target     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>        <span style="text-decoration: underline;">4</span>862. p2      target     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>        <span style="text-decoration: underline;">4</span>862. p2      target     0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="align-profiles">align profiles<a class="anchor" aria-label="anchor" href="#align-profiles"></a>
</h3>
<p>What are the times where pressure and syringe pump logs should be
aligned?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tPressure</span> <span class="op">&lt;-</span> <span class="fl">4862.1</span></span>
<span><span class="va">tSyringe</span> <span class="op">&lt;-</span> <span class="fl">4904.6</span></span></code></pre></div>
<p>Align pressure log to syringe pump log:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pressureAligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logfile_align_pressure.html">logfile_align_pressure</a></span><span class="op">(</span><span class="va">pressure</span>, <span class="va">syringe</span>, <span class="va">tPressure</span>, <span class="va">tSyringe</span><span class="op">)</span></span>
<span><span class="va">pressureAligned</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 394,856 × 5</span></span></span>
<span><span class="co">#&gt;    elapsed_time timestamp               channel value    mbar</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p1      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p1      read    0.612</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p2      target 50    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p2      read   50.0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p3      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p3      read    0.970</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p4      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         42.5 2022-08-05 <span style="color: #949494;">15:07:17.069</span> p4      read    0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         42.6 2022-08-05 <span style="color: #949494;">15:07:17.168</span> p1      target  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>         42.6 2022-08-05 <span style="color: #949494;">15:07:17.168</span> p1      read    0.605</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 394,846 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot">plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
<p>Remove unused channels:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">syringe</span> <span class="op">&lt;-</span> <span class="va">syringe</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">channel</span> <span class="op">!=</span> <span class="st">"q3"</span><span class="op">)</span></span>
<span><span class="va">pressureAligned</span> <span class="op">&lt;-</span> <span class="va">pressureAligned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">channel</span> <span class="op">==</span> <span class="st">"p2"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find out by how much the second y-axis has to be scaled:</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">syringe</span><span class="op">$</span><span class="va">flowrate</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pressureAligned</span><span class="op">$</span><span class="va">mbar</span><span class="op">)</span></span></code></pre></div>
<p>Merge pressure and syringe dataframes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="va">syringe</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">flowrate</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"syringe pump"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">pressureAligned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="st">"target"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">mbar</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"pressure controller"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scale pressure</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span> <span class="op">*</span> <span class="va">r</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">elapsed_time</span> <span class="op">/</span> <span class="fl">60</span>, y  <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">channel</span>, linetype <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="op">~</span><span class="va">.</span><span class="op">/</span><span class="va">r</span>, name <span class="op">=</span> <span class="st">"Pressure [mbar]"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/theme_pretty.html">theme_pretty</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Flowrate [ul/h]"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Elapsed time [min]"</span>,</span>
<span>       linetype <span class="op">=</span> <span class="st">"Instrument"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Channel"</span><span class="op">)</span></span></code></pre></div>
<p><img src="logfiles_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Fynn Withake.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
