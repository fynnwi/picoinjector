---
title: "FADS Analysis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{FADS Analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(picoinjector)
library(dplyr)
library(readr)
library(ggplot2)
```


## TSV file

Using the LabVIEW software, a TSV file can be recorded during an experiment, where every row corresponds to a droplet that is recognized by the sorter.
For a droplet flowing across the focus spot to be recognized, the signal captured by the PMT has to exceed a defined threshold in terms of amplitude and duration.
This way, droplets can be distinguished from the background signal.

```{r}
fads <- fads_read_tsv("data/fads/220916/pi30v4_0.txt")
fads
```

This function allows to plot the red against the green signal:

```{r}
fads %>% 
  fads_remove_outliers() %>%
  fads_plot_red_green()
```


Same plot, but with hexagonal glyphs:

```{r}
fads %>% 
  fads_remove_outliers() %>%
  fads_plot_red_green_hex()
```


Lets look at the signal width as well:

```{r}
fads %>% 
  # fads_remove_outliers() %>% 
  fads_plot_width()
```


Plot width vs. time:

```{r}
fads %>% 
  # fads_remove_outliers() %>% 
  fads_plot_width_time()
```


Plot signal vs. time:

```{r}
fads %>% 
  fads_remove_outliers() %>% 
  fads_plot_signal_time()
```


Plot droplet frequency over time:

```{r}
fads_plot_frequency(fads)
```


Over the course of this project, I collected many FADS tsv files.
From each of them, I want to generate a comprehensive report containing all the plots shown above with a single function call.
Probably the best way to this, is combining all the ggplot objects into one plot using patchwork:

```{r, fig.widt=20}
p <- fads_generate_report("data/fads/220916/pi30v4_6.txt")
p
```

Do this for all `.txt` files that were generate by the FADS setup:

```{r, eval=FALSE}
fads_reports_for_all("~/nyancat_tsv", "output/fads_data_exploration/")
```










